(function(e){e.tooltipsy=function(t,n){this.options=n;this.$el=e(t);this.title=this.$el.attr("title")||"";this.$el.attr("title","");this.random=parseInt(Math.random()*1e4);this.ready=false;this.shown=false;this.width=0;this.height=0;this.delaytimer=null;this.$el.data("tooltipsy",this);this.init()};e.tooltipsy.prototype={init:function(){var t=this,n,r=t.$el,i=r[0];t.settings=n=e.extend({},t.defaults,t.options);n.delay=+n.delay;if(typeof n.content==="function"){t.readify()}if(n.showEvent===n.hideEvent&&n.showEvent==="click"){r.toggle(function(e){if(n.showEvent==="click"&&i.tagName=="A"){e.preventDefault()}if(n.delay>0){t.delaytimer=window.setTimeout(function(){t.show(e)},n.delay)}else{t.show(e)}},function(e){if(n.showEvent==="click"&&i.tagName=="A"){e.preventDefault()}window.clearTimeout(t.delaytimer);t.delaytimer=null;t.hide(e)})}else{r.bind(n.showEvent,function(e){if(n.showEvent==="click"&&i.tagName=="A"){e.preventDefault()}t.delaytimer=window.setTimeout(function(){t.show(e)},n.delay||0)}).bind(n.hideEvent,function(e){if(n.showEvent==="click"&&i.tagName=="A"){e.preventDefault()}window.clearTimeout(t.delaytimer);t.delaytimer=null;t.hide(e)})}},show:function(t){if(this.ready===false){this.readify()}var n=this,r=n.settings,i=n.$tipsy,s=n.$el,o=s[0],u=n.offset(o);if(n.shown===false){if(function(e){var t=0,n;for(n in e){if(e.hasOwnProperty(n)){t++}}return t}(r.css)>0){n.$tip.css(r.css)}n.width=i.outerWidth();n.height=i.outerHeight()}if(r.alignTo==="cursor"&&t){var f=[t.clientX+r.offset[0],t.clientY+r.offset[1]];if(f[0]+n.width>e(window).width()){var l={top:f[1]+"px",right:f[0]+"px",left:"auto"}}else{var l={top:f[1]+"px",left:f[0]+"px",right:"auto"}}}else{var f=[function(){if(r.offset[0]<0){return u.left-Math.abs(r.offset[0])-n.width}else{if(r.offset[0]===0){return u.left-(n.width-s.outerWidth())/2}else{return u.left+s.outerWidth()+r.offset[0]}}}(),function(){if(r.offset[1]<0){return u.top-Math.abs(r.offset[1])-n.height}else{if(r.offset[1]===0){return u.top-(n.height-n.$el.outerHeight())/2}else{return u.top+n.$el.outerHeight()+r.offset[1]}}}()]}i.css({top:f[1]+"px",left:f[0]+"px"});n.settings.show(t,i.stop(true,true))},hide:function(e){var t=this;if(t.ready===false){return}if(e&&e.relatedTarget===t.$tip[0]){t.$tip.bind("mouseleave",function(e){if(e.relatedTarget===t.$el[0]){return}t.settings.hide(e,t.$tipsy.stop(true,true))});return}t.settings.hide(e,t.$tipsy.stop(true,true))},readify:function(){this.ready=true;this.$tipsy=e('<div id="tooltipsy'+this.random+'" class="tooltip-top" style="position:fixed;z-index:2147483647;display:none">').appendTo("body");this.$tip=e('<div class="'+this.settings.className+'">').appendTo(this.$tipsy);this.$tip.data("rootel",this.$el);var t=this.$el;var n=this.$tip;this.$tip.html(this.settings.content!=""?typeof this.settings.content=="string"?this.settings.content:this.settings.content(t,n):this.title)},offset:function(e){return this.$el[0].getBoundingClientRect()},destroy:function(){if(this.$tipsy){this.$tipsy.remove();e.removeData(this.$el,"tooltipsy")}},defaults:{alignTo:"element",offset:[0,-1],content:"",show:function(e,t){t.fadeIn(100)},hide:function(e,t){t.fadeOut(100)},css:{},className:"tooltipsy",delay:200,showEvent:"mouseenter",hideEvent:"mouseleave"}};e.fn.tooltipsy=function(t){return this.each(function(){new e.tooltipsy(this,t)})}})(jQuery)